(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["sub_pages/pages/appo/appo"],{31:function(e,t,a){"use strict";(function(e){a(5);n(a(4));var t=n(a(32));function n(e){return e&&e.__esModule?e:{default:e}}wx.__webpack_require_UNI_MP_PLUGIN__=a,e(t.default)}).call(this,a(1)["createPage"])},32:function(e,t,a){"use strict";a.r(t);var n=a(33),o=a(35);for(var s in o)"default"!==s&&function(e){a.d(t,e,(function(){return o[e]}))}(s);a(37);var r,i=a(11),u=Object(i["default"])(o["default"],n["render"],n["staticRenderFns"],!1,null,"e7434588",null,!1,n["components"],r);u.options.__file="sub_pages/pages/appo/appo.vue",t["default"]=u.exports},33:function(e,t,a){"use strict";a.r(t);var n=a(34);a.d(t,"render",(function(){return n["render"]})),a.d(t,"staticRenderFns",(function(){return n["staticRenderFns"]})),a.d(t,"recyclableRender",(function(){return n["recyclableRender"]})),a.d(t,"components",(function(){return n["components"]}))},34:function(e,t,a){"use strict";var n;a.r(t),a.d(t,"render",(function(){return o})),a.d(t,"staticRenderFns",(function(){return r})),a.d(t,"recyclableRender",(function(){return s})),a.d(t,"components",(function(){return n}));try{n={uniForms:function(){return Promise.all([a.e("common/vendor"),a.e("uni_modules/uni-forms/components/uni-forms/uni-forms")]).then(a.bind(null,100))},uniSection:function(){return a.e("uni_modules/uni-section/components/uni-section/uni-section").then(a.bind(null,109))},uniFormsItem:function(){return a.e("uni_modules/uni-forms/components/uni-forms-item/uni-forms-item").then(a.bind(null,116))},uniDataCheckbox:function(){return Promise.all([a.e("common/vendor"),a.e("uni_modules/uni-data-checkbox/components/uni-data-checkbox/uni-data-checkbox")]).then(a.bind(null,123))},uniPopup:function(){return a.e("uni_modules/uni-popup/components/uni-popup/uni-popup").then(a.bind(null,133))},uniEasyinput:function(){return a.e("uni_modules/uni-easyinput/components/uni-easyinput/uni-easyinput").then(a.bind(null,140))}}}catch(i){if(-1===i.message.indexOf("Cannot find module")||-1===i.message.indexOf(".vue"))throw i;console.error(i.message),console.error("1. 排查组件名称拼写是否正确"),console.error("2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom"),console.error("3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件")}var o=function(){var e=this,t=e.$createElement;e._self._c},s=!1,r=[];o._withStripped=!0},35:function(e,t,a){"use strict";a.r(t);var n=a(36),o=a.n(n);for(var s in n)"default"!==s&&function(e){a.d(t,e,(function(){return n[e]}))}(s);t["default"]=o.a},36:function(e,t,a){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(a(18)),o=a(21);function s(e){return e&&e.__esModule?e:{default:e}}function r(e,t,a,n,o,s,r){try{var i=e[s](r),u=i.value}catch(p){return void a(p)}i.done?t(u):Promise.resolve(u).then(n,o)}function i(e){return function(){var t=this,a=arguments;return new Promise((function(n,o){var s=e.apply(t,a);function i(e){r(s,n,o,i,u,"next",e)}function u(e){r(s,n,o,i,u,"throw",e)}i(void 0)}))}}var u={data:function(){return{openid:e.getStorageSync("openid")||"",dateValue:0,dateRange:[[],["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],["01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00","24:00"]],dateRangeChosen:[[],[],[]],dateTodayData:["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],firstDateChoosenIndex:0,secondDateChoosenIndex:0,thirdDateChoosenIndex:0,selectDate:"",stockType:"",stockAppoType:"",stockRange:[{value:1,text:"篮球"},{value:2,text:"足球"},{value:3,text:"游泳"},{value:4,text:"游泳"},{value:5,text:"游泳"},{value:6,text:"游泳"}],carValue:0,carRange:[{text:"机动车",value:0},{text:"非机动车",value:1}],groupValue:0,groupRange:[{value:0,text:"篮球"},{value:1,text:"足球"},{value:2,text:"游泳"}],platePlace:["沪","鲁","浙","苏","豫","皖","粤","辽","甘","闽","赣","冀","晋","京","津","渝","蒙","吉","黑","湘","鄂","桂","琼","川","贵","云","藏","陕","青","宁","新","港","澳","台"],plateTitle:"无",plateNum:"",plateArray:[],appoForData:{plate:"",supplier:"",brandName:"",goodsNum:"",goodsWeight:"",moreSupplier:{},moreBrandName:{}},supplierArray:[],brandNameArray:[],appoPeople:"",stockName:"",placeFrom:"",stockPlace:"",lotNum:"",entourageName:"",entouragePhone:"",entourageIdCard:"",entourageData:[]}},watch:{firstDateChoosenIndex:function(e){0===e?(this.dateRangeChosen[1]=JSON.parse(JSON.stringify(this.dateTodayData)),this.dateRangeChosen[2]=JSON.parse(JSON.stringify(this.dateTodayData)),this.dateRangeChosen[2].splice(0,1),this.dateRangeChosen[2].push("00:00")):(this.dateRangeChosen[1]=JSON.parse(JSON.stringify(this.dateRange[1])),this.dateRangeChosen[2]=JSON.parse(JSON.stringify(this.dateRange[2]))),this.secondDateChoosenIndex=0,this.thirdDateChoosenIndex=0},secondDateChoosenIndex:function(e){if(0===this.firstDateChoosenIndex){var t=this.get_date(new Date," "),a=(parseInt(t.time.split(":")[0]),JSON.parse(JSON.stringify(this.dateTodayData)));this.dateRangeChosen[2]=a.splice(parseInt(e)),this.dateRangeChosen[2].splice(0,1),this.dateRangeChosen[2].push("00:00")}else{var n=JSON.parse(JSON.stringify(this.dateRange));this.dateRangeChosen[2]=n[2].splice(parseInt(e))}this.thirdDateChoosenIndex=0,console.log(this.thirdDateChoosenIndex),this.selectDate=this.dateRangeChosen[0][this.firstDateChoosenIndex]+" "+this.dateRangeChosen[1][this.secondDateChoosenIndex]+"-"+this.dateRangeChosen[2][this.thirdDateChoosenIndex],console.log("侦听器"+this.selectDate)}},onLoad:function(t){console.log(t.type),this.dateRangeChosen=JSON.parse(JSON.stringify(this.dateRange));var a=this.get_date(new Date," "),n=parseInt(a.time.split(":")[0]);this.dateRangeChosen[1]=this.dateTodayData.splice(n),this.dateRangeChosen[2]=JSON.parse(JSON.stringify(this.dateRangeChosen[1])),this.dateRangeChosen[2].splice(0,1).push("00:00"),this.dateTodayData=JSON.parse(JSON.stringify(this.dateRangeChosen[1])),console.log(this.dateRangeChosen);for(var o=0;o<3;o++){var s=this.get_date(Date.now()+24*o*60*60*1e3,"-");this.dateRangeChosen[0].push(s.date)}switch(parseInt(t.type)){case 1:this.stockType="蔬菜",this.stockAppoType="蔬菜";break;case 2:this.stockType="果品",this.stockAppoType="果品";break;case 3:this.stockType="肉类",this.stockAppoType="肉类";break;case 4:this.stockType="干货",this.stockAppoType="干货";break;case 5:this.stockType="粮油",this.stockAppoType="粮油";break;case 6:this.stockType="国产冻品",this.stockAppoType="国产货";break;case 7:this.stockType="进口冷链",this.stockAppoType="进口货";break}this.selectDate=this.dateRangeChosen[0][0]+" "+this.dateRangeChosen[1][0]+"-"+this.dateRangeChosen[2][0],e.setNavigationBarTitle({title:this.stockType})},methods:{onGetLastestAppoData:function(){var t=this;return i(n.default.mark((function a(){var s,r,i,u,p,c,l,h,d,g,f,m,y;return n.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,(0,o.getLastestAppoData)(t.openid);case 2:if(s=a.sent,r=s.data,console.log(r.Data),i=r.Data[0],i.preType==t.stockAppoType){for("机动车"==i.viecleType?t.carValue=0:t.carValue=1,t.plateArray=[],i.plateNo[0]&&(t.plateArray=i.plateNo),t.supplierArray=[],i.supplier[0]&&(t.supplierArray=i.supplier),t.brandNameArray=[],u=0;u<i.variety.length;u++)p=i.variety[u].split(" "),p[0]&&(c={brandName:p[0]},p[1]&&(p[1].indexOf("个")&&(l=p[1].slice(0,p[1].length-1),c["goodsNum"]=l),p[1].indexOf("kg")&&(h=p[1].slice(0,p[1].length-2),c["goodsWeight"]=h)),p[2]&&(p[2].indexOf("个")&&(d=p[2].slice(0,p[2].length-1),c["goodsNum"]=d),p[2].indexOf("kg")&&(g=p[2].slice(0,p[2].length-2),c["goodsWeight"]=g)),t.brandNameArray.push(c));for(t.entourageData=[],f=0;f<i.crews.length;f++)m=i.crews[f].split(" "),m[0]&&(y={name:m[0]},m[1]&&(11==m[1].length&&(y["phone"]=m[1]),18==m[1].length&&(y["idCard"]=m[1])),m[2]&&(11==m[2].length&&(y["phone"]=m[2]),18==m[2].length&&(y["idCard"]=m[2])),t.entourageData.push(y),console.log(t.entourageData));t.stockAppoType=i.preType,t.placeFrom=i.source,t.stockPlace=i.stall,t.stockName=i.owner,t.selectDate=i.preTime,t.appoPeople=i.crewCount,t.lotNum=i.batchNo}else i.dept?e.showModal({title:"获取失败",content:"上一条预报类型是".concat(i.dept),showCancel:!0,success:function(e){e.confirm,e.cancel}}):e.showModal({title:"获取失败",content:"暂无预报信息",showCancel:!0,success:function(e){e.confirm,e.cancel}});case 7:case"end":return a.stop()}}),a)})))()},resetData:function(){this.plateArray=[],this.supplierArray=[],this.brandNameArray=[],this.carValue=0,this.entourageData=[],this.placeFrom="",this.stockPlace="",this.stockName="",this.selectDate=this.dateRangeChosen[0][0]+" "+this.dateRangeChosen[1][0]+"-"+this.dateRangeChosen[2][0],this.appoPeople="",this.lotNum="",console.log("重置信息")},onSubmit:function(){var t=this;return i(n.default.mark((function a(){var s,r,i,u,p,c,l,h,d,g,f;return n.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:for(a.prev=0,6!==(t.plateTitle+t.plateNum).length&&7!==(t.plateTitle+t.plateNum).length||(t.plateArray.push(t.plateTitle+t.plateNum),t.plateTitle="",t.plateNum=""),t.appoForData.supplier&&(t.supplierArray.push(t.appoForData.supplier),t.appoForData.supplier=""),t.appoForData.brandName&&(t.brandNameArray.push({brandName:t.appoForData.brandName,goodsNum:t.appoForData.goodsNum,goodsWeight:t.appoForData.goodsWeight}),t.appoForData.brandName="",t.appoForData.goodsNum="",t.appoForData.goodsWeight=""),t.addEntourage(),s=[],r=0,i=0,u=0;u<t.brandNameArray.length;u++)p=t.brandNameArray[u].brandName,t.brandNameArray[u].goodsNum&&(p=p+" "+t.brandNameArray[u].goodsNum+"件",r+=parseFloat(t.brandNameArray[u].goodsNum)),t.brandNameArray[u].goodsWeight&&(p=p+" "+t.brandNameArray[u].goodsWeight+"kg",i+=parseFloat(t.brandNameArray[u].goodsWeight)),s.push(p);for(c=[],l=0;l<t.entourageData.length;l++)h=t.entourageData[l].name,t.entourageData[l].phone&&11==t.entourageData[l].phone.length&&(h=h+" "+t.entourageData[l].phone),t.entourageData[l].idCard&&18==t.entourageData[l].idCard.length&&(h=h+" "+t.entourageData[l].idCard),c.push(h);if(console.log(c.join(";")),0!=t.plateArray.length||0!=t.carValue){a.next=16;break}e.showModal({title:"预报失败",content:"至少填写一个车牌号",showCancel:!0}),a.next=28;break;case 16:if(0!=t.brandNameArray.length){a.next=20;break}e.showModal({title:"预报失败",content:"至少填写一个品种",showCancel:!0}),a.next=28;break;case 20:return d=0,t.appoPeople&&(d=parseInt(t.appoPeople)),a.next=24,(0,o.upLoadAppoData)(t.openid,t.stockType,t.stockAppoType,t.carRange[t.carValue].text,t.plateArray.join(";"),t.supplierArray.join(";"),s.join(";"),r,i,t.placeFrom,t.stockPlace,t.stockName,t.selectDate,d,c.join(";"),t.lotNum);case 24:g=a.sent,f=g.data,console.log(f),e.showModal({title:"预报结果",content:f.Message,showCancel:!0,success:function(t){t.confirm,t.cancel;e.reLaunch({url:"/sub_pages/pages/appo_type/appo_type"})}});case 28:a.next=34;break;case 30:a.prev=30,a.t0=a["catch"](0),console.log("提交出错"),console.log(a.t0);case 34:case"end":return a.stop()}}),a,null,[[0,30]])})))()},addPlate:function(){var t=this.plateTitle+this.plateNum;t&&this.plateNum.length>=6?("无"!=this.plateTitle&&this.plateArray.push(t),this.plateTitle="无",this.plateNum="",console.log(this.plateArray)):e.showModal({title:"请填写完整车牌",content:"",showCancel:!0,success:function(e){e.confirm,e.cancel}})},delTag:function(e){var t=this.plateArray.indexOf(e);this.plateArray.splice(t,1)},addSupplier:function(){this.appoForData.supplier?(this.supplierArray.push(this.appoForData.supplier),this.appoForData.supplier=""):e.showModal({title:"请填写供应商",content:"",showCancel:!0,success:function(e){e.confirm,e.cancel}})},delSupplier:function(e){var t=this.supplierArray.indexOf(e);this.supplierArray.splice(t,1)},addBrandName:function(){this.appoForData.brandName?(this.brandNameArray.push({brandName:this.appoForData.brandName,goodsNum:this.appoForData.goodsNum,goodsWeight:this.appoForData.goodsWeight}),this.appoForData.brandName="",this.appoForData.goodsNum="",this.appoForData.goodsWeight=""):e.showModal({title:"请填写完整品名",content:"",showCancel:!0,success:function(e){e.confirm,e.cancel}})},delBrandTag:function(e){var t=this.brandNameArray.indexOf(e);this.brandNameArray.splice(t,1)},changeLog:function(e){console.log("change事件:",e)},addEntourage:function(){if(this.entourageName){var e={name:this.entourageName,id:Date.now()};this.entouragePhone&&11===this.entouragePhone.length&&(e["phone"]=this.entouragePhone),this.entourageIdCard&&18===this.entourageIdCard.length&&(e["idCard"]=this.entourageIdCard),this.entourageData.push(e),this.entourageIdCard="",this.entourageName="",this.entouragePhone=""}},delEntourage:function(e){var t=this.entourageData.findIndex((function(t){return t.id===e}));this.entourageData.splice(t,1)},openPlateTitle:function(){this.$refs.popup.open()},choosePlate:function(e){this.plateTitle=e,this.$refs.popup.close()},dateChange:function(e){0==e.detail.column?this.firstDateChoosenIndex=e.detail.value:1==e.detail.column?this.secondDateChoosenIndex=e.detail.value:2==e.detail.column&&(this.thirdDateChoosenIndex=e.detail.value),this.selectDate=this.dateRangeChosen[0][this.firstDateChoosenIndex]+" "+this.dateRangeChosen[1][this.secondDateChoosenIndex]+"-"+this.dateRangeChosen[2][this.thirdDateChoosenIndex],console.log("函数"+this.selectDate)},get_date:function(e,t){var a=new Date(e),n=a.getFullYear(),o=a.getMonth()+1<10?"0"+(a.getMonth()+1):a.getMonth()+1,s=a.getDate()<10?"0"+a.getDate():a.getDate(),r=a.getHours()<10?"0"+a.getHours():a.getHours(),i=a.getMinutes()<10?"0"+a.getMinutes():a.getMinutes(),u=a.getSeconds()<10?"0"+a.getSeconds():a.getSeconds(),p=n+t+o+t+s,c=r+":"+i+":"+u,l={date:p,time:c,datetime:p+" "+c};return l}}};t.default=u}).call(this,a(1)["default"])},37:function(e,t,a){"use strict";a.r(t);var n=a(38),o=a.n(n);for(var s in n)"default"!==s&&function(e){a.d(t,e,(function(){return n[e]}))}(s);t["default"]=o.a},38:function(e,t,a){}},[[31,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../../.sourcemap/mp-weixin/sub_pages/pages/appo/appo.js.map